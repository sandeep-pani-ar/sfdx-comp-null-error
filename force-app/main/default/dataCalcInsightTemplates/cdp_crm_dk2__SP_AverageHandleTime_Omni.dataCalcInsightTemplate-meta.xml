<?xml version="1.0" encoding="UTF-8"?>
<DataCalcInsightTemplate xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <builderExpression xsi:nil="true"/>
    <creationType>Custom</creationType>
    <dataspaceName>default</dataspaceName>
    <dataspacePrefix xsi:nil="true"/>
    <definitionType>CALCULATED_METRIC</definitionType>
    <description xsi:nil="true"/>
    <developerName>SP_AverageHandleTime_Omni</developerName>
    <expression>SELECT SUM(CASE WHEN ssot__GeneratedOperationPlan__dlm.ssot__RelatedReferenceId__c IS NULL THEN ssot__AgentWork__dlm.ssot__HandleTimeSeconds__c END) /
COUNT(CASE WHEN ssot__GeneratedOperationPlan__dlm.ssot__RelatedReferenceId__c IS NULL THEN 1 END)AS AHT_Without_ServicePlan__c,
SUM(CASE WHEN ssot__GeneratedOperationPlan__dlm.ssot__RelatedReferenceId__c IS NOT NULL THEN 
ssot__AgentWork__dlm.ssot__HandleTimeSeconds__c END) /
COUNT(CASE WHEN ssot__GeneratedOperationPlan__dlm.ssot__RelatedReferenceId__c IS NOT NULL THEN 1 END)AS AHT_With_ServicePlan__c
FROM ssot__AgentWork__dlm
LEFT JOIN ssot__GeneratedOperationPlan__dlm ON ssot__AgentWork__dlm.ssot__RelatedToId__c = ssot__GeneratedOperationPlan__dlm.ssot__RelatedReferenceId__c</expression>
    <masterLabel>SP_AverageHandleTime_Omni</masterLabel>
</DataCalcInsightTemplate>
