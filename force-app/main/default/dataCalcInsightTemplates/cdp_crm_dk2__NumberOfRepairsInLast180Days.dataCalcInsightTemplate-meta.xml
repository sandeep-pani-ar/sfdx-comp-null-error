<?xml version="1.0" encoding="UTF-8"?>
<DataCalcInsightTemplate xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <builderExpression>{&quot;version&quot;:&quot;2.0&quot;,&quot;app&quot;:{&quot;insightType&quot;:&quot;CALCULATED_METRIC&quot;},&quot;dataNodes&quot;:{&quot;LOAD_DATA_SOURCE0&quot;:{&quot;id&quot;:&quot;LOAD_DATA_SOURCE0&quot;,&quot;action&quot;:&quot;load&quot;,&quot;parameters&quot;:{&quot;dataset&quot;:{&quot;label&quot;:&quot;Asset&quot;,&quot;name&quot;:&quot;ssot__Asset__dlm&quot;,&quot;creationType&quot;:&quot;Standard&quot;,&quot;isExternal&quot;:false,&quot;isExternalObjectInErrorStatus&quot;:false,&quot;type&quot;:&quot;dmo&quot;},&quot;fields&quot;:[&quot;ssot__Id__c&quot;,&quot;ssot__AssetLevelNumber__c&quot;,&quot;ssot__Name__c&quot;,&quot;ssot__AssetQuantity__c&quot;,&quot;ssot__AssetStatus__c&quot;,&quot;ssot__AvailablePercent__c&quot;,&quot;ssot__AverageUptimePerDayMinutesQuantity__c&quot;,&quot;ssot__BillToAccountId__c&quot;,&quot;ssot__CnsqncOfAssetFailure__c&quot;,&quot;ssot__CreatedById__c&quot;,&quot;ssot__CreatedDate__c&quot;,&quot;ssot__DataSourceId__c&quot;,&quot;ssot__DataSourceObjectId__c&quot;,&quot;ssot__Description__c&quot;,&quot;ssot__DigitalAssetStatus__c&quot;,&quot;ssot__DigitalAssetStatusReason__c&quot;,&quot;ssot__DowntimeSumQuantity__c&quot;,&quot;ssot__ExpectedUptimePercent__c&quot;,&quot;ssot__ExternalRecordId__c&quot;,&quot;ssot__GeocodeAccuracyType__c&quot;,&quot;ssot__InstallDateTime__c&quot;,&quot;ssot__InternalOrganizationId__c&quot;,&quot;ssot__IsCompetitorAsset__c&quot;,&quot;ssot__IsDeleted__c&quot;,&quot;ssot__isInternal__c&quot;,&quot;KQ_Id__c&quot;,&quot;KQ_LocationId__c&quot;,&quot;KQ_ParentAssetId__c&quot;,&quot;KQ_ProductId__c&quot;,&quot;KQ_RootAssetId__c&quot;,&quot;ssot__LastModifiedById__c&quot;,&quot;ssot__LastModifiedDate__c&quot;,&quot;ssot__Latitude__c&quot;,&quot;ssot__LocationId__c&quot;,&quot;ssot__Longitude__c&quot;,&quot;ssot__ManufactureDate__c&quot;,&quot;ssot__ParentAssetId__c&quot;,&quot;ssot__PriceAmount__c&quot;,&quot;ssot__PrimaryContactId__c&quot;,&quot;ssot__ProductId__c&quot;,&quot;ssot__ProductCodeText__c&quot;,&quot;ssot__ProductDescription__c&quot;,&quot;ssot__ProductFamilyName__c&quot;,&quot;ssot__PurchaseDate__c&quot;,&quot;ssot__RootAssetId__c&quot;,&quot;ssot__SerialNumber__c&quot;,&quot;ssot__ServicerAccountId__c&quot;,&quot;ssot__StockKeepingUnit__c&quot;,&quot;ssot__SupplierAccountId__c&quot;,&quot;ssot__SystemModstamp__c&quot;,&quot;ssot__TotalUsage__c&quot;,&quot;ssot__TotalUsageUnitOfMeasure__c&quot;,&quot;ssot__UniqueIdentifier__c&quot;,&quot;ssot__UnplannedDowntimeSumQuantity__c&quot;,&quot;ssot__UptimeRecordEndDateTime__c&quot;,&quot;ssot__UptimeRecordStartDateTime__c&quot;]},&quot;sources&quot;:[]},&quot;LOAD_DATA_SOURCE1&quot;:{&quot;id&quot;:&quot;LOAD_DATA_SOURCE1&quot;,&quot;action&quot;:&quot;load&quot;,&quot;parameters&quot;:{&quot;dataset&quot;:{&quot;label&quot;:&quot;Work Order&quot;,&quot;name&quot;:&quot;ssot__WorkOrder__dlm&quot;,&quot;creationType&quot;:&quot;Standard&quot;,&quot;isExternal&quot;:false,&quot;isExternalObjectInErrorStatus&quot;:false,&quot;type&quot;:&quot;dmo&quot;},&quot;fields&quot;:[&quot;ssot__AccountId__c&quot;,&quot;ssot__AccountContactId__c&quot;,&quot;ssot__AssetId__c&quot;,&quot;ssot__AssetWarrantyTermId__c&quot;,&quot;ssot__CaseId__c&quot;,&quot;ssot__ContractId__c&quot;,&quot;ssot__CreatedById__c&quot;,&quot;ssot__CreatedDate__c&quot;,&quot;ssot__DataSourceId__c&quot;,&quot;ssot__DataSourceObjectId__c&quot;,&quot;ssot__Description__c&quot;,&quot;ssot__DiscountPercent__c&quot;,&quot;ssot__DurationQuantity__c&quot;,&quot;ssot__DurationInMinutes__c&quot;,&quot;ssot__DurationUOMId__c&quot;,&quot;ssot__EndDateTime__c&quot;,&quot;ssot__EntitlementProcessEndDateTime__c&quot;,&quot;ssot__EntitlementProcessStartDateTime__c&quot;,&quot;ssot__GeocodeAccuracy__c&quot;,&quot;ssot__GrandTotalAmount__c&quot;,&quot;ssot__IsClosed__c&quot;,&quot;ssot__IsGeneratedFromMaintenancePlan__c&quot;,&quot;ssot__IsMilestoneCountdownStopped__c&quot;,&quot;KQ_AssetId__c&quot;,&quot;KQ_AssetWarrantyTermId__c&quot;,&quot;KQ_ContractId__c&quot;,&quot;KQ_LocationId__c&quot;,&quot;KQ_ParentWorkOrderId__c&quot;,&quot;KQ_PriceBookId__c&quot;,&quot;KQ_RootWorkOrderId__c&quot;,&quot;KQ_Id__c&quot;,&quot;KQ_WorkTypeId__c&quot;,&quot;ssot__LastModifiedById__c&quot;,&quot;ssot__LastModifiedDate__c&quot;,&quot;ssot__LineItemCount__c&quot;,&quot;ssot__LocationId__c&quot;,&quot;ssot__MilestoneCountdownStopDateTime__c&quot;,&quot;ssot__MilestoneStatusCode__c&quot;,&quot;ssot__MinimumCrewSizeNumber__c&quot;,&quot;ssot__OperatingHoursId__c&quot;,&quot;ssot__OwnerId__c&quot;,&quot;ssot__ParentWorkOrderId__c&quot;,&quot;ssot__PriceBookId__c&quot;,&quot;ssot__RecommendedCrewSizeNumber__c&quot;,&quot;ssot__RootWorkOrderId__c&quot;,&quot;ssot__ServiceAppointmentCount__c&quot;,&quot;ssot__ServiceReportLanguage__c&quot;,&quot;ssot__StartDateTime__c&quot;,&quot;ssot__SubTotalAmount__c&quot;,&quot;ssot__SubjectText__c&quot;,&quot;ssot__SuggestedMaintenanceDateTime__c&quot;,&quot;ssot__SystemModstamp__c&quot;,&quot;ssot__TaxAmount__c&quot;,&quot;ssot__TotalPriceAmount__c&quot;,&quot;ssot__Id__c&quot;,&quot;ssot__WorkOrderNumber__c&quot;,&quot;ssot__WorkOrderPriority__c&quot;,&quot;ssot__WorkOrderStatus__c&quot;,&quot;ssot__WorkOrderStatusCategory__c&quot;,&quot;ssot__WorkTypeId__c&quot;]},&quot;sources&quot;:[]},&quot;JOIN0&quot;:{&quot;id&quot;:&quot;JOIN0&quot;,&quot;action&quot;:&quot;join&quot;,&quot;parameters&quot;:{&quot;joinType&quot;:&quot;left_join&quot;,&quot;leftKeys&quot;:[&quot;ssot__Id__c&quot;,&quot;KQ_Id__c&quot;],&quot;rightKeys&quot;:[&quot;ssot__AssetId__c&quot;,&quot;KQ_AssetId__c&quot;],&quot;rightQualifier&quot;:&quot;WorkOrder&quot;},&quot;sources&quot;:[&quot;LOAD_DATA_SOURCE0&quot;,&quot;LOAD_DATA_SOURCE1&quot;]},&quot;CASE0&quot;:{&quot;id&quot;:&quot;CASE0&quot;,&quot;action&quot;:&quot;case&quot;,&quot;parameters&quot;:{&quot;cases&quot;:[{&quot;name&quot;:&quot;IsRecentRepair&quot;,&quot;label&quot;:&quot;IsRecentRepair&quot;,&quot;returnValueType&quot;:&quot;number&quot;,&quot;whenConditions&quot;:[{&quot;expression&quot;:{&quot;expressionType&quot;:&quot;group&quot;,&quot;expressionValues&quot;:[{&quot;expressionType&quot;:&quot;condition&quot;,&quot;leftOperand&quot;:{&quot;resourceType&quot;:&quot;field&quot;,&quot;valueType&quot;:&quot;text&quot;,&quot;source&quot;:&quot;JOIN0&quot;,&quot;value&quot;:&quot;WorkOrder.ssot__IsGeneratedFromMaintenancePlan__c&quot;},&quot;operator&quot;:&quot;equal&quot;,&quot;rightOperands&quot;:[{&quot;resourceType&quot;:&quot;constant&quot;,&quot;value&quot;:&quot;false&quot;,&quot;valueType&quot;:&quot;text&quot;}]},{&quot;expressionType&quot;:&quot;operator&quot;,&quot;operator&quot;:&quot;and&quot;},{&quot;expressionType&quot;:&quot;condition&quot;,&quot;leftOperand&quot;:{&quot;resourceType&quot;:&quot;field&quot;,&quot;valueType&quot;:&quot;text&quot;,&quot;source&quot;:&quot;JOIN0&quot;,&quot;value&quot;:&quot;WorkOrder.ssot__EndDateTime__c&quot;},&quot;operator&quot;:&quot;last_n_days&quot;,&quot;rightOperands&quot;:[{&quot;resourceType&quot;:&quot;constant&quot;,&quot;value&quot;:180,&quot;valueType&quot;:&quot;number&quot;}]}]},&quot;returnValue&quot;:{&quot;resourceType&quot;:&quot;constant&quot;,&quot;value&quot;:1,&quot;valueType&quot;:&quot;number&quot;}}],&quot;elseCondition&quot;:{&quot;returnValue&quot;:{&quot;resourceType&quot;:&quot;constant&quot;,&quot;value&quot;:0,&quot;valueType&quot;:&quot;number&quot;}}}]},&quot;sources&quot;:[&quot;JOIN0&quot;]},&quot;AGGREGATE0&quot;:{&quot;id&quot;:&quot;AGGREGATE0&quot;,&quot;action&quot;:&quot;aggregate&quot;,&quot;parameters&quot;:{&quot;measures&quot;:[{&quot;name&quot;:&quot;RecentRepairs&quot;,&quot;label&quot;:&quot;RecentRepairs&quot;,&quot;functionName&quot;:&quot;sum&quot;,&quot;parameters&quot;:{&quot;expression&quot;:{&quot;resourceType&quot;:&quot;field&quot;,&quot;valueType&quot;:&quot;text&quot;,&quot;value&quot;:&quot;IsRecentRepair&quot;,&quot;source&quot;:&quot;CASE0&quot;}}}],&quot;dimensions&quot;:[{&quot;name&quot;:&quot;AssetId&quot;,&quot;label&quot;:&quot;AssetId&quot;,&quot;resource&quot;:{&quot;resourceType&quot;:&quot;field&quot;,&quot;valueType&quot;:&quot;text&quot;,&quot;value&quot;:&quot;ssot__Id__c&quot;,&quot;source&quot;:&quot;CASE0&quot;}},{&quot;name&quot;:&quot;KeyQualifierAssetId&quot;,&quot;label&quot;:&quot;KeyQualifierAssetId&quot;,&quot;resource&quot;:{&quot;resourceType&quot;:&quot;field&quot;,&quot;valueType&quot;:&quot;text&quot;,&quot;value&quot;:&quot;KQ_Id__c&quot;,&quot;source&quot;:&quot;CASE0&quot;}},{&quot;name&quot;:&quot;KeyQualifierAsset&quot;,&quot;label&quot;:&quot;KeyQualifierAsset&quot;,&quot;resource&quot;:{&quot;resourceType&quot;:&quot;field&quot;,&quot;valueType&quot;:&quot;text&quot;,&quot;value&quot;:&quot;WorkOrder.KQ_AssetId__c&quot;,&quot;source&quot;:&quot;CASE0&quot;}}]},&quot;sources&quot;:[&quot;CASE0&quot;]}},&quot;ui&quot;:{&quot;nodes&quot;:{&quot;LOAD_DATA_SOURCE0&quot;:{&quot;label&quot;:&quot;Asset&quot;,&quot;type&quot;:&quot;LOAD_DATA_SOURCE&quot;,&quot;top&quot;:112,&quot;left&quot;:112},&quot;LOAD_DATA_SOURCE1&quot;:{&quot;label&quot;:&quot;Work Order&quot;,&quot;type&quot;:&quot;LOAD_DATA_SOURCE&quot;,&quot;top&quot;:252,&quot;left&quot;:112},&quot;JOIN0&quot;:{&quot;label&quot;:&quot;Join&quot;,&quot;type&quot;:&quot;JOIN&quot;,&quot;top&quot;:112,&quot;left&quot;:252},&quot;CASE0&quot;:{&quot;label&quot;:&quot;Determine Recent Repairs&quot;,&quot;type&quot;:&quot;CASE&quot;,&quot;top&quot;:112,&quot;left&quot;:392},&quot;AGGREGATE0&quot;:{&quot;label&quot;:&quot;Specify Output&quot;,&quot;type&quot;:&quot;AGGREGATE&quot;,&quot;top&quot;:112,&quot;left&quot;:532}},&quot;connectors&quot;:[{&quot;targetNodeId&quot;:&quot;JOIN0&quot;,&quot;sourceNodeId&quot;:&quot;LOAD_DATA_SOURCE0&quot;},{&quot;targetNodeId&quot;:&quot;JOIN0&quot;,&quot;sourceNodeId&quot;:&quot;LOAD_DATA_SOURCE1&quot;},{&quot;targetNodeId&quot;:&quot;CASE0&quot;,&quot;sourceNodeId&quot;:&quot;JOIN0&quot;},{&quot;targetNodeId&quot;:&quot;AGGREGATE0&quot;,&quot;sourceNodeId&quot;:&quot;CASE0&quot;}]}}</builderExpression>
    <creationType>Custom</creationType>
    <dataspaceName>default</dataspaceName>
    <dataspacePrefix xsi:nil="true"/>
    <definitionType>CALCULATED_METRIC</definitionType>
    <description>Determine total number of work orders that weren’t created as part of a maintenance plan in the last six months. For example, this includes work orders created manually by your service team.</description>
    <developerName>NumberOfRepairsInLast180Days</developerName>
    <expression>SELECT
  SUM( CASE  WHEN (
  ssot__WorkOrder__dlm.ssot__IsGeneratedFromMaintenancePlan__c = &apos;false&apos;
  and (ssot__WorkOrder__dlm.ssot__EndDateTime__c &gt;= date_sub(current_date(), 180))
) THEN 1 ELSE 0 END) AS recentrepairs__c,
  ssot__Asset__dlm.ssot__Id__c AS assetid__c,
  ssot__Asset__dlm.KQ_Id__c AS keyqualifierassetid__c,
  ssot__WorkOrder__dlm.KQ_AssetId__c AS keyqualifierasset__c
FROM ssot__Asset__dlm
  LEFT OUTER JOIN ssot__WorkOrder__dlm
    ON (ssot__Asset__dlm.ssot__Id__c = ssot__WorkOrder__dlm.ssot__AssetId__c AND ssot__Asset__dlm.KQ_Id__c = ssot__WorkOrder__dlm.KQ_AssetId__c)
GROUP BY
  assetid__c,
  keyqualifierassetid__c,
  keyqualifierasset__c</expression>
    <masterLabel>NumberOfRepairsInLast180Days</masterLabel>
</DataCalcInsightTemplate>
